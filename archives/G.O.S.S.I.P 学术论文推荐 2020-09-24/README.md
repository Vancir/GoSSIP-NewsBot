 今天我们为大家推荐2021年IEEE S&P会议上的一篇论文，这篇论文讨论了编译器代码优化对反汇编分析过程中函数签名（function signature）的识别产生的（正面与负面并存）的影响 

    
 

  ![]() 

  在二进制代码的控制流图（CFG）分析中，识别间接调用（indirect call）往往是分析的难点，如果无法准确找到所有的调用关系，对控制流完整性（CFI）的实现就难以做到尽善尽美。一些已有的工作（如TypeArmor）在二进制代码上对函数的调用约定（call convention）进行分析并生成函数签名，为caller和callee寻找配对关系。 

    
 

  ![]() 

    
 

  为了研究编译器优化对基于函数签名的识别工作的影响，本文的作者详细分析了编译器存在的8类对函数签名的改变，其中包括对使用stack还是使用register来进行参数传递的识别的影响，对特定寄存器的使用的误判，   
 

    
 

  ![]() 

    
 

  ![]() 

    
 

  ![]() 

  ![]() 

  ![]() 

    
 

  作者研究表明，在分析过程中，很多干扰来自于编译器的不同优化选项产生的多样性，因此作者提出了compiler-optimization-friendly policies来细粒度处理不同的代码，先对代码的优化级别进行分析，然后采取不同的函数签名识别策略。作者针对1344个程序（552 C and 792 C++，使用gcc-8和clang-7从-O0到-O3编译选项）的分析表明，针对参数个数和参数类型的分析，使用了作者提出的策略都会得到更好的结果（同已有三个工具TypeArmor, τCFI, Ghidra对比） 

    
 

  

  论文PDF： 

  https://www.computer.org/csdl/proceedings-article/sp/2021/893400a091/1mbmHtHLPAA 

